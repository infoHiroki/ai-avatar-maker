# ãƒ†ã‚¹ãƒˆè¨ˆç”»æ›¸

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå**: ãƒ–ãƒ­ã‚°è¨˜äº‹â†’YouTubeå‹•ç”»è‡ªå‹•ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**ä½œæˆæ—¥**: 2025å¹´11æœˆ15æ—¥

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ†ã‚¹ãƒˆæˆ¦ç•¥](#ãƒ†ã‚¹ãƒˆæˆ¦ç•¥)
2. [ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ](#ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ)
3. [çµ±åˆãƒ†ã‚¹ãƒˆ](#çµ±åˆãƒ†ã‚¹ãƒˆ)
4. [E2Eãƒ†ã‚¹ãƒˆ](#e2eãƒ†ã‚¹ãƒˆ)
5. [ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§](#ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§)
6. [ãƒ†ã‚¹ãƒˆç’°å¢ƒ](#ãƒ†ã‚¹ãƒˆç’°å¢ƒ)

---

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰

```
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  E2Eãƒ†ã‚¹ãƒˆ  â”‚ å°‘ï¼ˆæ‰‹å‹•ãƒ†ã‚¹ãƒˆä¸­å¿ƒï¼‰
        â”‚    (5%)    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  çµ±åˆãƒ†ã‚¹ãƒˆ â”‚ ä¸­ï¼ˆAPIçµ±åˆï¼‰
        â”‚   (25%)    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ ãƒ¦ãƒ‹ãƒƒãƒˆ   â”‚ å¤šï¼ˆé–¢æ•°ãƒ¬ãƒ™ãƒ«ï¼‰
        â”‚  ãƒ†ã‚¹ãƒˆ    â”‚
        â”‚   (70%)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ†ã‚¹ãƒˆæ–¹é‡

```yaml
è‡ªå‹•åŒ–ãƒ¬ãƒ™ãƒ«:
  - ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: 100%è‡ªå‹•åŒ–
  - çµ±åˆãƒ†ã‚¹ãƒˆ: 80%è‡ªå‹•åŒ–ï¼ˆAPI Mockingã‚‚ä½¿ç”¨ï¼‰
  - E2Eãƒ†ã‚¹ãƒˆ: 50%è‡ªå‹•åŒ–ã€50%æ‰‹å‹•

ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™:
  - ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: 80%ä»¥ä¸Š
  - çµ±åˆãƒ†ã‚¹ãƒˆ: ä¸»è¦ãƒ•ãƒ­ãƒ¼100%
  - E2Eãƒ†ã‚¹ãƒˆ: ãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹ + ä¸»è¦ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹

ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯:
  - pytest: ãƒ¦ãƒ‹ãƒƒãƒˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ
  - pytest-mock: Mocking
  - pytest-asyncio: éåŒæœŸãƒ†ã‚¹ãƒˆ
  - Streamlit testing: UI ãƒ†ã‚¹ãƒˆ
```

---

## ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆå¯¾è±¡

```yaml
modules/chatgpt.py:
  - generate_script()
  - fetch_blog_content()
  - call_chatgpt_api()

modules/cartesia.py:
  - CartesiaClient.generate()
  - CartesiaClient._connect()
  - CartesiaClient._upload_to_cloudinary()

modules/did.py:
  - DIDClient.create_talk()
  - DIDClient.poll_status()

modules/youtube.py:
  - upload_video()
  - download_video()

utils/config.py:
  - load_config()

utils/errors.py:
  - ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹
```

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ conftest.py                # pytestè¨­å®šãƒ»ãƒ•ã‚£ã‚¯ã‚¹ãƒãƒ£
â”œâ”€â”€ test_chatgpt.py
â”œâ”€â”€ test_cartesia.py
â”œâ”€â”€ test_did.py
â”œâ”€â”€ test_youtube.py
â”œâ”€â”€ test_config.py
â””â”€â”€ test_integration.py        # çµ±åˆãƒ†ã‚¹ãƒˆ
```

### ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆ

#### test_chatgpt.py

```python
import pytest
from unittest.mock import patch, Mock
from modules.chatgpt import generate_script, fetch_blog_content

class TestGenerateScript:
    """ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆã®ãƒ†ã‚¹ãƒˆ"""

    @pytest.fixture
    def mock_blog_content(self):
        """ãƒ–ãƒ­ã‚°è¨˜äº‹ã®ãƒ¢ãƒƒã‚¯"""
        return """
        ä»Šæ—¥ã¯Pythonã®å‹ãƒ’ãƒ³ãƒˆã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚
        å‹ãƒ’ãƒ³ãƒˆã‚’ä½¿ã†ã¨ã€ã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ãŒå‘ä¸Šã—ã€
        ãƒã‚°ã‚’æ—©æœŸã«ç™ºè¦‹ã§ãã¾ã™ã€‚
        """

    @patch("modules.chatgpt.fetch_blog_content")
    @patch("modules.chatgpt.call_chatgpt_api")
    def test_generate_script_success(
        self,
        mock_chatgpt,
        mock_fetch,
        mock_blog_content
    ):
        """æ­£å¸¸ç³»: ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”ŸæˆæˆåŠŸ"""
        # Mockè¨­å®š
        mock_fetch.return_value = (mock_blog_content, None)
        mock_chatgpt.return_value = ("ä»Šæ—¥ã¯å‹ãƒ’ãƒ³ãƒˆã«ã¤ã„ã¦...", None)

        # å®Ÿè¡Œ
        script, err = generate_script(
            "https://blog.example.com/post1",
            max_words=150
        )

        # æ¤œè¨¼
        assert err is None
        assert script is not None
        assert "å‹ãƒ’ãƒ³ãƒˆ" in script
        mock_fetch.assert_called_once()
        mock_chatgpt.assert_called_once()

    @patch("modules.chatgpt.fetch_blog_content")
    def test_generate_script_fetch_error(self, mock_fetch):
        """ç•°å¸¸ç³»: ãƒ–ãƒ­ã‚°è¨˜äº‹å–å¾—å¤±æ•—"""
        # Mockè¨­å®š: ã‚¨ãƒ©ãƒ¼è¿”å´
        mock_fetch.return_value = (None, Exception("404 Not Found"))

        # å®Ÿè¡Œ
        script, err = generate_script("https://invalid-url.com")

        # æ¤œè¨¼
        assert script is None
        assert err is not None
        assert "404" in str(err)

    def test_fetch_blog_content_invalid_url(self):
        """ç•°å¸¸ç³»: ç„¡åŠ¹ãªURL"""
        # å®Ÿè¡Œ
        content, err = fetch_blog_content("invalid-url")

        # æ¤œè¨¼
        assert content is None
        assert err is not None
```

#### test_cartesia.py

```python
import pytest
from unittest.mock import patch, Mock, AsyncMock
from modules.cartesia import CartesiaClient

class TestCartesiaClient:
    """Cartesia APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆ"""

    @pytest.fixture
    def client(self):
        """ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹"""
        return CartesiaClient(
            api_key="test_api_key",
            voice_id="test_voice_id"
        )

    @pytest.mark.asyncio
    @patch("modules.cartesia.websockets.connect")
    async def test_generate_success(self, mock_ws, client):
        """æ­£å¸¸ç³»: éŸ³å£°ç”ŸæˆæˆåŠŸ"""
        # WebSocket Mockã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        mock_connection = AsyncMock()
        mock_connection.recv = AsyncMock(side_effect=[
            '{"type":"audio","data":"SGVsbG8="}',  # Base64
            '{"type":"done"}'
        ])
        mock_ws.return_value.__aenter__.return_value = mock_connection

        # å®Ÿè¡Œ
        audio_data, err = await client.generate("ã“ã‚“ã«ã¡ã¯")

        # æ¤œè¨¼
        assert err is None
        assert audio_data is not None
        assert isinstance(audio_data, bytes)

    @pytest.mark.asyncio
    @patch("modules.cartesia.websockets.connect")
    async def test_generate_websocket_error(self, mock_ws, client):
        """ç•°å¸¸ç³»: WebSocketæ¥ç¶šã‚¨ãƒ©ãƒ¼"""
        # Mockè¨­å®š: æ¥ç¶šã‚¨ãƒ©ãƒ¼
        mock_ws.side_effect = Exception("Connection refused")

        # å®Ÿè¡Œ
        audio_data, err = await client.generate("ã“ã‚“ã«ã¡ã¯")

        # æ¤œè¨¼
        assert audio_data is None
        assert err is not None
        assert "Connection refused" in str(err)
```

#### conftest.py

```python
import pytest
import os

@pytest.fixture(scope="session")
def test_config():
    """ãƒ†ã‚¹ãƒˆç”¨è¨­å®š"""
    return {
        "openai_api_key": "test_openai_key",
        "cartesia_api_key": "test_cartesia_key",
        "did_api_key": "test_did_key"
    }

@pytest.fixture
def mock_env_vars(monkeypatch):
    """ç’°å¢ƒå¤‰æ•°ã®ãƒ¢ãƒƒã‚¯"""
    monkeypatch.setenv("OPENAI_API_KEY", "test_key")
    monkeypatch.setenv("CARTESIA_API_KEY", "test_key")
    monkeypatch.setenv("DID_API_KEY", "test_key")
```

---

## çµ±åˆãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆå¯¾è±¡

```yaml
APIçµ±åˆ:
  - ChatGPT APIå‘¼ã³å‡ºã—ï¼ˆå®ŸAPIä½¿ç”¨ï¼‰
  - Cartesia APIå‘¼ã³å‡ºã—ï¼ˆMockï¼‰
  - D-ID APIå‘¼ã³å‡ºã—ï¼ˆMockï¼‰
  - Cloudinary APIï¼ˆMockï¼‰
  - YouTube APIï¼ˆMockï¼‰

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“é€£æº:
  - chatgpt â†’ cartesia
  - cartesia â†’ did
  - did â†’ youtube
```

### test_integration.py

```python
import pytest
from modules import chatgpt, cartesia, did

class TestEndToEndFlow:
    """E2Eãƒ•ãƒ­ãƒ¼ã®çµ±åˆãƒ†ã‚¹ãƒˆ"""

    @pytest.mark.integration
    @pytest.mark.asyncio
    async def test_blog_to_video_flow(self, test_config):
        """çµ±åˆãƒ†ã‚¹ãƒˆ: ãƒ–ãƒ­ã‚°â†’å‹•ç”»ã®å…¨ãƒ•ãƒ­ãƒ¼"""

        # Step 1: ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ
        script, err = chatgpt.generate_script(
            "https://example.com/test-blog",
            max_words=150,
            api_key=test_config["openai_api_key"]
        )
        assert err is None
        assert script is not None

        # Step 2: éŸ³å£°ç”Ÿæˆï¼ˆMockï¼‰
        client = cartesia.CartesiaClient(
            api_key=test_config["cartesia_api_key"],
            voice_id="test_voice"
        )
        # Mockã‚’ä½¿ç”¨
        with patch.object(client, "generate") as mock_generate:
            mock_generate.return_value = ("https://audio.url", None)
            audio_url, err = await client.generate(script)

        assert err is None
        assert audio_url is not None

        # Step 3: å‹•ç”»ç”Ÿæˆï¼ˆMockï¼‰
        did_client = did.DIDClient(api_key=test_config["did_api_key"])
        with patch.object(did_client, "generate") as mock_did:
            mock_did.return_value = ("https://video.url", None)
            video_url, err = did_client.generate(
                audio_url=audio_url,
                avatar_url="https://avatar.jpg"
            )

        assert err is None
        assert video_url is not None
```

---

## E2Eãƒ†ã‚¹ãƒˆ

### æ‰‹å‹•ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

#### TC-E2E-001: ãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹

```yaml
ãƒ†ã‚¹ãƒˆå: ãƒ–ãƒ­ã‚°â†’YouTubeå‹•ç”»ç”Ÿæˆï¼ˆæ­£å¸¸ç³»ï¼‰

å‰ææ¡ä»¶:
  - Streamlitã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã¦ã„ã‚‹
  - ã™ã¹ã¦ã®APIã‚­ãƒ¼ãŒè¨­å®šæ¸ˆã¿
  - ãƒ†ã‚¹ãƒˆç”¨ãƒ–ãƒ­ã‚°è¨˜äº‹ãŒå­˜åœ¨

æ‰‹é †:
  1. ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹
     æœŸå¾…: ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹

  2. ãƒ–ãƒ­ã‚°URLã‚’å…¥åŠ›
     å…¥åŠ›: https://test-blog.com/post1
     æœŸå¾…: URLãŒå—ã‘ä»˜ã‘ã‚‰ã‚Œã‚‹

  3. ã‚¢ãƒã‚¿ãƒ¼ã‚’é¸æŠ
     é¸æŠ: ã€Œã‚¹ãƒ¼ãƒ„ã€
     æœŸå¾…: é¸æŠãŒåæ˜ ã•ã‚Œã‚‹

  4. ã€Œå‹•ç”»ç”Ÿæˆé–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
     æœŸå¾…: é€²æ—è¡¨ç¤ºãŒé–‹å§‹ã•ã‚Œã‚‹

  5. ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆå®Œäº†ã‚’å¾…ã¤
     æœŸå¾…:
       - ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹
       - ã€Œâœ“ ç¢ºå®šã€ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹

  6. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç¢ºèªã—ã€Œâœ“ ç¢ºå®šã€ã‚’ã‚¯ãƒªãƒƒã‚¯
     æœŸå¾…: æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚€

  7. éŸ³å£°ç”Ÿæˆå®Œäº†ã‚’å¾…ã¤
     æœŸå¾…:
       - é€²æ—ãƒãƒ¼ãŒ100%ã«ãªã‚‹
       - éŸ³å£°ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

  8. å‹•ç”»ç”Ÿæˆå®Œäº†ã‚’å¾…ã¤ï¼ˆ5åˆ†ç¨‹åº¦ï¼‰
     æœŸå¾…:
       - å‹•ç”»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
       - ã€ŒğŸ“º YouTubeæŠ•ç¨¿ã€ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹

  9. å‹•ç”»ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
     æœŸå¾…:
       - å‹•ç”»ãŒå†ç”Ÿã§ãã‚‹
       - ãƒªãƒƒãƒ—ã‚·ãƒ³ã‚¯ãŒè‡ªç„¶

  10. ã€ŒğŸ“º YouTubeæŠ•ç¨¿ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
      æœŸå¾…:
        - YouTube URLãŒè¡¨ç¤ºã•ã‚Œã‚‹
        - ä¸‹æ›¸ãã¨ã—ã¦æŠ•ç¨¿ã•ã‚Œã¦ã„ã‚‹

åˆæ ¼åŸºæº–:
  - ã™ã¹ã¦ã®æ‰‹é †ãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†
  - å‹•ç”»ã®å“è³ªãŒè‰¯å¥½
  - YouTubeæŠ•ç¨¿ãŒæˆåŠŸ
```

#### TC-E2E-002: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```yaml
ãƒ†ã‚¹ãƒˆå: ç„¡åŠ¹ãªãƒ–ãƒ­ã‚°URLã®å‡¦ç†

æ‰‹é †:
  1. ç„¡åŠ¹ãªURLã‚’å…¥åŠ›
     å…¥åŠ›: "invalid-url"
  2. ã€Œå‹•ç”»ç”Ÿæˆé–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

æœŸå¾…çµæœ:
  - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: "ç„¡åŠ¹ãªURLã§ã™"
  - ã‚¢ãƒ—ãƒªãŒã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„
```

#### TC-E2E-003: APIåˆ¶é™æ™‚ã®å‡¦ç†

```yaml
ãƒ†ã‚¹ãƒˆå: APIä½¿ç”¨é‡è¶…éæ™‚ã®å‡¦ç†

å‰ææ¡ä»¶:
  - Cartesia APIã®ä½¿ç”¨é‡ãŒä¸Šé™ã«è¿‘ã„

æ‰‹é †:
  1. é€šå¸¸ã®å‹•ç”»ç”Ÿæˆãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ
  2. éŸ³å£°ç”Ÿæˆã‚¹ãƒ†ãƒƒãƒ—ã§APIåˆ¶é™ã«é”ã™ã‚‹

æœŸå¾…çµæœ:
  - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
  - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: "APIä½¿ç”¨é‡ãŒä¸Šé™ã«é”ã—ã¾ã—ãŸ"
  - å¯¾å‡¦æ–¹æ³•ãŒæç¤ºã•ã‚Œã‚‹
```

---

## ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§

### æ©Ÿèƒ½åˆ¥ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

| ID | ã‚«ãƒ†ã‚´ãƒª | ãƒ†ã‚¹ãƒˆå†…å®¹ | å„ªå…ˆåº¦ | è‡ªå‹•åŒ– |
|----|---------|-----------|--------|--------|
| TC-001 | ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ | æ­£å¸¸ãªãƒ–ãƒ­ã‚°URLã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ | é«˜ | âœ… |
| TC-002 | ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ | ç„¡åŠ¹ãªURLã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | é«˜ | âœ… |
| TC-003 | ã‚¹ã‚¯ãƒªãƒ—ãƒˆç”Ÿæˆ | é•·æ–‡è¨˜äº‹ã®æ–‡å­—æ•°åˆ¶é™ | ä¸­ | âœ… |
| TC-004 | éŸ³å£°ç”Ÿæˆ | æ­£å¸¸ãªãƒ†ã‚­ã‚¹ãƒˆã§éŸ³å£°ç”Ÿæˆ | é«˜ | âš ï¸ |
| TC-005 | éŸ³å£°ç”Ÿæˆ | WebSocketæ¥ç¶šã‚¨ãƒ©ãƒ¼ | é«˜ | âœ… |
| TC-006 | å‹•ç”»ç”Ÿæˆ | æ­£å¸¸ãªéŸ³å£°URLã§å‹•ç”»ç”Ÿæˆ | é«˜ | âš ï¸ |
| TC-007 | å‹•ç”»ç”Ÿæˆ | ãƒãƒ¼ãƒªãƒ³ã‚°ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ | ä¸­ | âœ… |
| TC-008 | YouTubeæŠ•ç¨¿ | æ­£å¸¸ãªå‹•ç”»URLã§æŠ•ç¨¿ | é«˜ | âŒ |
| TC-009 | YouTubeæŠ•ç¨¿ | OAuthèªè¨¼ã‚¨ãƒ©ãƒ¼ | ä¸­ | âŒ |
| TC-010 | E2E | ãƒ•ãƒ«ãƒ•ãƒ­ãƒ¼ï¼ˆãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹ï¼‰ | é«˜ | âŒ |

å‡¡ä¾‹:
- âœ…: è‡ªå‹•åŒ–æ¸ˆã¿
- âš ï¸: éƒ¨åˆ†çš„ã«è‡ªå‹•åŒ–ï¼ˆMockingã‚’ä½¿ç”¨ï¼‰
- âŒ: æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

---

## ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ä»®æƒ³ç’°å¢ƒä½œæˆ
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# ãƒ†ã‚¹ãƒˆä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements-dev.txt
```

#### requirements-dev.txt

```
# requirements-dev.txt
-r requirements.txt

# ãƒ†ã‚¹ãƒˆ
pytest==7.4.0
pytest-asyncio==0.21.0
pytest-mock==3.11.1
pytest-cov==4.1.0

# ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
black==23.7.0
flake8==6.0.0
mypy==1.4.1
```

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
pytest

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ã
pytest --cov=modules --cov-report=html

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿
pytest tests/test_chatgpt.py

# ãƒãƒ¼ã‚«ãƒ¼åˆ¥å®Ÿè¡Œ
pytest -m integration  # çµ±åˆãƒ†ã‚¹ãƒˆã®ã¿
pytest -m "not integration"  # ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ã¿

# ä¸¦åˆ—å®Ÿè¡Œï¼ˆé«˜é€ŸåŒ–ï¼‰
pytest -n auto
```

### CI/CDçµ±åˆï¼ˆGitHub Actionsï¼‰

```.yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: Install dependencies
      run: |
        pip install -r requirements-dev.txt

    - name: Run tests
      run: |
        pytest --cov=modules --cov-report=xml

    - name: Upload coverage
      uses: codecov/codecov-action@v3
```

---

## ãƒ†ã‚¹ãƒˆå®Œäº†åŸºæº–

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```yaml
åˆæ ¼åŸºæº–:
  âœ… ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
  âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
  âœ… ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯é€šéï¼ˆblack, flake8ï¼‰
  âœ… å‹ãƒã‚§ãƒƒã‚¯é€šéï¼ˆmypyï¼‰
```

### çµ±åˆãƒ†ã‚¹ãƒˆ

```yaml
åˆæ ¼åŸºæº–:
  âœ… ä¸»è¦ãƒ•ãƒ­ãƒ¼ãŒã™ã¹ã¦æˆåŠŸ
  âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡
  âœ… ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ãŒå‹•ä½œ
```

### E2Eãƒ†ã‚¹ãƒˆ

```yaml
åˆæ ¼åŸºæº–:
  âœ… ãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹ãŒæˆåŠŸ
  âœ… ä¸»è¦ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãŒé©åˆ‡ã«å‡¦ç†ã•ã‚Œã‚‹
  âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒè‰¯å¥½
  âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒè¦ä»¶ã‚’æº€ãŸã™ï¼ˆ10åˆ†ä»¥å†…ï¼‰
```

---

**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ15æ—¥
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼**: ãƒ†ã‚¹ãƒˆå®Ÿæ–½å¾Œ
